

<h1>Automated Vulnerability Management Nessus Essentials & Ansible</h1>
<h2>Check out the blog post on my website for more detail</h2>

### [Blog Post](https://stefancooke.tech/automated-vulnerability-management-nessus-essentials-ansible/)

<h2>Description</h2>
This repository serves as a comprehensive guide and resource for using Ansible to automate security updates in order to fix vulnerabilities found from Nessus Essentials scans.

<br />

<h2>Features</h2>

- Credentialed Scans: Learn how to configure and execute credentialed scans using Nessus Essentials, gaining deeper insights into your system's security posture.
- Vulnerability Detection: Understand how Nessus identifies vulnerabilities, providing detailed reports on potential security risks within your environment.
- Remediation Strategies: Explore best practices and step-by-step guides for addressing vulnerabilities discovered during Nessus scans, ensuring a more secure infrastructure.


<h2>Languages, Environments and Utilities Used</h2>

- <b>Tennable Nessus Essentials</b>
- <b>Windows 10</b>
- <b>Virtual Machine</b>
- <b>Kali Linux</b>
- <b>Ansible</b>
- <b>OpenSSH</b>
  


<h2>Program walk-through:</h2>

<p align="center">
Install Ansible on Linux: <br/>
<img src="https://github.com/stefancooke/Vulnerability-Management-Tenable-Nessus-Essentials-/assets/119261557/a01cfefb-dffb-4b28-9143-a55a707ae68b" height="80%" width="80%" alt="Install Ansible on Linux"/>
<br />
<br />
Install OpenSSH on your Windows Server. This allows you to secure shell into it later and control the system from Linux:  <br/>
<img src="https://github.com/stefancooke/Vulnerability-Management-Tenable-Nessus-Essentials-/assets/119261557/e6ded660-6bd4-45ad-b164-b4d11bc0ce50" height="80%" width="80%" alt="Install OpenSSH on your Windows Server. This allows you to secure shell into it later and control the system from Linux"/>
<br />
<br />
Update Firewall Settings to Allow Ansible and OpenSSH: <br/>
<img src="https://github.com/stefancooke/Vulnerability-Management-Tenable-Nessus-Essentials-/assets/119261557/6e03db42-cdf4-4626-8bfd-d107a36a6dc2" height="80%" width="80%" alt="Update Firewall Settings to Allow Ansible and OpenSSH"/>
<br />
<br />
This is the configuration file for the host servers which are the Windows servers, if there are multiple this would be updated and there would be more IP addresses. Ansible uses these variables to login to the Windoes system. The password variable is in cleartext which is a vulnerability, it is a better idea to use SSH keypair with public and private keys to access the server, but for simplicity passwords are presented to Ansible: <br/>
<img src="https://github.com/stefancooke/Vulnerability-Management-Tenable-Nessus-Essentials-/assets/119261557/f0d77149-d8a0-4d83-b1ef-83b3dd563141" height="80%" width="80%" alt="This is the configuration file for the host servers which are the Windows servers, if there are multiple this would be updated and there would be more IP addresses. Ansible uses these variables to login to the Windoes system. The password variable is in cleartext which is a vulnerability, it is a better idea to use SSH keypair with public and private keys to access the server, but for simplicity passwords are presented to Ansible."/>
<br />
<br />
Ensure the correct security policies are selected, enable logon through remote desktop services: <br/>
<img src="https://github.com/stefancooke/Vulnerability-Management-Tenable-Nessus-Essentials-/assets/119261557/8a985bbb-7b1a-43f6-8208-451be30c0655" height="80%" width="80%" alt="Install Ansible on Linux"/>
<br />
<br />
Test connectivity and make sure you are able to access the system via SSH through using the win_ping command: <br/>
<img src="https://github.com/stefancooke/Vulnerability-Management-Tenable-Nessus-Essentials-/assets/119261557/73935894-3e35-4cab-8314-de696cdbc872" height="80%" width="80%" alt="Install Ansible on Linux"/>
<br />
<br />
Launch a test playbook to make sure everything is functional: <br/>
<img src="https://github.com/stefancooke/Vulnerability-Management-Tenable-Nessus-Essentials-/assets/119261557/549fbf40-c202-481a-9a8e-f778c04d167f" height="80%" width="80%" alt="Install Ansible on Linux"/>
<br />
<br />
Open Nessus and go to the credentialed scan and look for vulnerabilities which can be patched with a windows updates: <br/>
<img src="https://github.com/stefancooke/Vulnerability-Management-Tenable-Nessus-Essentials-/assets/119261557/db95eab3-b05b-494a-a1a7-765566f09a74" height="80%" width="80%" alt="Install Ansible on Linux"/>
<br />
<br />
Here there are some vulnerabilities with the KB updates as they are outdated. So these must be patched, make sure to make note of the update numbers: <br/>
<img src="https://github.com/stefancooke/Vulnerability-Management-Tenable-Nessus-Essentials-/assets/119261557/67f23f7f-75ba-4db4-81a8-82e1c715f58d" height="80%" width="80%" alt="Install Ansible on Linux"/>
<br />
<br />
This vulnerability allows Elevation of Privilege  and Remote Code execution, and is a critical vulnerability which needs to be patched: <br/>
<img src="https://github.com/stefancooke/Vulnerability-Management-Tenable-Nessus-Essentials-/assets/119261557/1398fcb6-9af0-4df9-9ada-d52459b4c254" height="80%" width="80%" alt="Install Ansible on Linux"/>
<br />
<br />
Create a playbook to address the issues and patch the fixes: <br/>
<img src="https://github.com/stefancooke/Vulnerability-Management-Tenable-Nessus-Essentials-/assets/119261557/28c034b7-f969-40c8-a701-4e2b04d4d3c0" height="80%" width="80%" alt="Install Ansible on Linux"/>
<br />
<br />
However this playbook didnt work due to lack of privilege and not being able to become an admin on the Windows Server, so you must adjust the privileges or update the playbook: <br/>
<img src="https://github.com/stefancooke/Vulnerability-Management-Tenable-Nessus-Essentials-/assets/119261557/19796403-bca7-4e98-9db4-00018e088471" height="80%" width="80%" alt="Install Ansible on Linux"/>
<br />
<br />
Updated playbook to use CMD commands instead of Powershell commands : <br/>
<img src="https://github.com/stefancooke/Vulnerability-Management-Tenable-Nessus-Essentials-/assets/119261557/9e5f203b-9c97-4c9c-b124-c7acc5bbdb2c" height="80%" width="80%" alt="Install Ansible on Linux"/>
<br />
<br />
Run Playbook - Success (The updates have been installed and the vulnerability is mitigated): <br/>
<img src="https://github.com/stefancooke/Vulnerability-Management-Tenable-Nessus-Essentials-/assets/119261557/59bc2ca9-c559-4ac8-b68f-646a6ca268a0" height="80%" width="80%" alt="Install Ansible on Linux"/>
<br />
<br />



</p>

<!--
 ```diff
- text in red
+ text in green
! text in orange
# text in gray
@@ text in purple (and bold)@@
```
--!>
